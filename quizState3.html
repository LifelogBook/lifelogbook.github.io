<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U.S. Map Quiz!</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        #quiz-area {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #map-container {
            width: 100%;
            max-width: 700px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
        }
        #map-container path {
            fill: #d3d3d3;
            stroke: #888;
            stroke-width: 1.5;
            transition: fill 0.3s ease;
        }
        #map-container .highlighted {
            fill: #ff6347;
        }
        .input-group {
            margin-bottom: 15px;
            width: 80%;
        }
        .input-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .input-group input {
            width: 100%;
            padding: 10px;
            font-size: 1.2em;
            border: 2px solid #ddd;
            border-radius: 5px;
        }
        #submit-button {
            padding: 10px 20px;
            font-size: 1.2em;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #submit-button:hover {
            background-color: #0056b3;
        }
        #result-area {
            margin-top: 20px;
            font-size: 1.2em;
            min-height: 40px;
        }
        .correct {
            color: #28a745;
            font-weight: bold;
        }
        .incorrect {
            color: #dc3545;
            font-weight: bold;
        }
        .play-again-button {
            padding: 10px 25px;
            font-size: 1.1em;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
        }
    </style>
</head>
<body>

<div class="container" id="quiz-container">
    <h1>U.S. Map Quiz!</h1>
    <p id="instruction">Type the name and capital city of the highlighted state.</p>
    <div id="quiz-area">
        <div id="map-container">
            </div>
        <div class="input-group">
            <label for="state-input">State Name:</label>
            <input type="text" id="state-input" placeholder="e.g., California">
        </div>
        <div class="input-group">
            <label for="capital-input">Capital City:</label>
            <input type="text" id="capital-input" placeholder="e.g., Sacramento">
        </div>
        <button id="submit-button">Submit</button>
        <p id="result-area"></p>
    </div>
</div>

<script>
    // 미국 주와 수도 데이터를 저장하는 객체입니다.
    const stateData = {
        'AL': { name: 'Alabama', capital: 'Montgomery' }, 'AK': { name: 'Alaska', capital: 'Juneau' }, 'AZ': { name: 'Arizona', capital: 'Phoenix' }, 'AR': { name: 'Arkansas', capital: 'Little Rock' }, 'CA': { name: 'California', capital: 'Sacramento' }, 'CO': { name: 'Colorado', capital: 'Denver' },
        'CT': { name: 'Connecticut', capital: 'Hartford' }, 'DE': { name: 'Delaware', capital: 'Dover' }, 'FL': { name: 'Florida', capital: 'Tallahassee' }, 'GA': { name: 'Georgia', capital: 'Atlanta' }, 'HI': { name: 'Hawaii', capital: 'Honolulu' }, 'ID': { name: 'Idaho', capital: 'Boise' },
        'IL': { name: 'Illinois', capital: 'Springfield' }, 'IN': { name: 'Indiana', capital: 'Indianapolis' }, 'IA': { name: 'Iowa', capital: 'Des Moines' }, 'KS': { name: 'Kansas', capital: 'Topeka' }, 'KY': { name: 'Kentucky', capital: 'Frankfort' }, 'LA': { name: 'Louisiana', capital: 'Baton Rouge' },
        'ME': { name: 'Maine', capital: 'Augusta' }, 'MD': { name: 'Maryland', capital: 'Annapolis' }, 'MA': { name: 'Massachusetts', capital: 'Boston' }, 'MI': { name: 'Michigan', capital: 'Lansing' }, 'MN': { name: 'Minnesota', capital: 'Saint Paul' }, 'MS': { name: 'Mississippi', capital: 'Jackson' },
        'MO': { name: 'Missouri', capital: 'Jefferson City' }, 'MT': { name: 'Montana', capital: 'Helena' }, 'NE': { name: 'Nebraska', capital: 'Lincoln' }, 'NV': { name: 'Nevada', capital: 'Carson City' }, 'NH': { name: 'New Hampshire', capital: 'Concord' }, 'NJ': { name: 'New Jersey', capital: 'Trenton' },
        'NM': { name: 'New Mexico', capital: 'Santa Fe' }, 'NY': { name: 'New York', capital: 'Albany' }, 'NC': { name: 'North Carolina', capital: 'Raleigh' }, 'ND': { name: 'North Dakota', capital: 'Bismarck' }, 'OH': { name: 'Ohio', capital: 'Columbus' }, 'OK': { name: 'Oklahoma', capital: 'Oklahoma City' },
        'OR': { name: 'Oregon', capital: 'Salem' }, 'PA': { name: 'Pennsylvania', capital: 'Harrisburg' }, 'RI': { name: 'Rhode Island', capital: 'Providence' }, 'SC': { name: 'South Carolina', capital: 'Columbia' }, 'SD': { name: 'South Dakota', capital: 'Pierre' }, 'TN': { name: 'Tennessee', capital: 'Nashville' },
        'TX': { name: 'Texas', capital: 'Austin' }, 'UT': { name: 'Utah', capital: 'Salt Lake City' }, 'VT': { name: 'Vermont', capital: 'Montpelier' }, 'VA': { name: 'Virginia', capital: 'Richmond' }, 'WA': { name: 'Washington', capital: 'Olympia' }, 'WV': { name: 'West Virginia', capital: 'Charleston' },
        'WI': { name: 'Wisconsin', capital: 'Madison' }, 'WY': { name: 'Wyoming', capital: 'Cheyenne' }
    };

    let allStateIDs = Object.keys(stateData);
    let shuffledStateIDs = [];
    let currentQuestionIndex = 0;
    let currentQuestionStateID = '';
    let score = 0;
    const totalQuestions = 50;

    const quizContainer = document.getElementById('quiz-container');

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function startQuiz() {
        console.log('Quiz is starting...');
        
        quizContainer.innerHTML = `
            <h1>U.S. Map Quiz!</h1>
            <p id="instruction">Type the name and capital city of the highlighted state.</p>
            <div id="quiz-area">
                <div id="map-container"></div>
                <div class="input-group">
                    <label for="state-input">State Name:</label>
                    <input type="text" id="state-input" placeholder="e.g., California">
                </div>
                <div class="input-group">
                    <label for="capital-input">Capital City:</label>
                    <input type="text" id="capital-input" placeholder="e.g., Sacramento">
                </div>
                <button id="submit-button">Submit</button>
                <p id="result-area"></p>
            </div>
        `;

        const newMapContainer = document.getElementById('map-container');
        fetch('us_map.svg')
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.text();
            })
            .then(svgText => {
                newMapContainer.innerHTML = svgText;
                shuffledStateIDs = Object.keys(stateData);
                shuffleArray(shuffledStateIDs);
                currentQuestionIndex = 0;
                score = 0;
                loadQuestion();
            })
            .catch(error => {
                console.error('Error loading SVG map:', error);
                newMapContainer.innerHTML = '<p style="color: red;">Failed to load map. Please check the `us_map.svg` file path.</p>';
            });

        document.getElementById('submit-button').addEventListener('click', checkAnswer);
        document.getElementById('state-input').addEventListener('keydown', handleKeyDown);
        document.getElementById('capital-input').addEventListener('keydown', handleKeyDown);
    }

    function handleKeyDown(event) {
        if (event.key === 'Enter') {
            checkAnswer();
        }
    }

    function loadQuestion() {
        const questionNumber = currentQuestionIndex + 1;
        if (questionNumber > totalQuestions) {
            endQuiz();
            return;
        }

        const instruction = document.getElementById('instruction');
        const stateInput = document.getElementById('state-input');
        const capitalInput = document.getElementById('capital-input');
        const resultArea = document.getElementById('result-area');

        instruction.textContent = `Question ${questionNumber}/${totalQuestions} | Score: ${score}`;
        
        const previousStatePath = document.querySelector('.highlighted');
        if (previousStatePath) {
            previousStatePath.classList.remove('highlighted');
        }

        currentQuestionStateID = shuffledStateIDs[currentQuestionIndex];
        const currentStatePath = document.getElementById(currentQuestionStateID);

        if (currentStatePath) {
            currentStatePath.classList.add('highlighted');
        } else {
            console.error(`Error: Path element with ID "${currentQuestionStateID}" was not found!`);
        }

        stateInput.value = '';
        capitalInput.value = '';
        resultArea.innerHTML = '';
        stateInput.focus();
    }

    function checkAnswer() {
        const stateInput = document.getElementById('state-input');
        const capitalInput = document.getElementById('capital-input');
        const resultArea = document.getElementById('result-area');
        
        const userAnswerState = stateInput.value.trim().toLowerCase();
        const userAnswerCapital = capitalInput.value.trim().toLowerCase();
        
        const correctState = stateData[currentQuestionStateID].name.toLowerCase();
        const correctCapital = stateData[currentQuestionStateID].capital.toLowerCase();

        if (userAnswerState === correctState && userAnswerCapital === correctCapital) {
            resultArea.innerHTML = `<span class="correct">Correct!</span>`;
            score++;
        } else {
            resultArea.innerHTML = `<span class="incorrect">Incorrect. The correct answer is: State - ${stateData[currentQuestionStateID].name}, Capital - ${stateData[currentQuestionStateID].capital}.</span>`;
        }

        currentQuestionIndex++;
        setTimeout(loadQuestion, 3000);
    }

    function endQuiz() {
        document.getElementById('quiz-area').innerHTML = `
            <h2>Quiz finished!</h2>
            <p>You got ${score} out of ${totalQuestions} questions correct. Great job!</p>
        `;
        const playAgainButton = document.createElement('button');
        playAgainButton.textContent = 'Play Again';
        playAgainButton.className = 'play-again-button';
        playAgainButton.addEventListener('click', startQuiz);
        document.getElementById('quiz-area').appendChild(playAgainButton);
    }

    window.onload = startQuiz;
</script>

</body>
</html>